{% extends 'base.html.twig' %}

{% block title %}List of Order{% endblock %}

{% block body %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
<style>
    .display-product-table table {
      width: 80%;
      text-align: center;
    }

    .display-product-table table thead th {
      padding: 1rem;
      font-size: 1.25rem;
      font-family:Palatino;
      background-color: #708090;
      color: white;
    }

    .display-product-table table td {
      padding: 1rem;
      font-size: 1rem;
      color: var(--black);
      background-color: var(--black);
    }

    .display-product-table table td:first-child {
      padding: 0;
    }

    .display-product-table table tr:nth-child(odd) {
      background-color: #f9f9f9;
      color: black;
    }

    .display-product-table table tr:nth-child(even) {
      background-color: #ececec; 
      color: black;
    }

    .display-product-table .empty {
      margin-bottom: 2rem;
      text-align: center;
      background-color: var(--bg-black);
      color: var(--black);
      font-size: 2rem;
      padding: 1.5rem;
    }
      
    .product-image {
      max-width: 150px; 
      max-height: 150px; 
      object-fit: contain; 
    }
    
    .btn {
      width: 80%;
      text-align: center;
      font-size: 1rem;
      padding: 0.3rem 0.5rem;
      border-radius: 0.5rem;
      cursor: pointer;
      margin-top: 1rem;
    }
    
    .btn:hover {
      background-color: var(--black);
      color: var(--white);
    }

    .btn.btn-danger {
      background-color: red;
      color: #ececec;
    }
 .pagination {
  list-style: none;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 18px;
  padding: 0;
}

.pagination li {
  margin-top:20px;
  color: #708090;
  background-color: #708090;
}

.pagination li.active {
  font-weight: bold;
}

.pagination li a {
  display: block;
  padding: 5px 10px;
  color: black;
  background-color: white;
  border: 1px solid #ccc;
  border-radius: 3px;
}

.pagination li a:hover {
  background-color: gray;
  color: white;
}

    .btn.btn-warning {
      background-color: orange;
      color: #ececec;
    }
</style>

<div class="container">
    <div style="align-items: center">
        <section class="display-product-table">
        <div style="display: flex; justify-content: center;">
            <table class="table table-bordered" style="border">
                <thead>
                    <tr>
                        <th>Index</th>
                        <th>ID</th>
                        <th>Customer Name</th>
                        <th>Customer Address</th>
                        <th>Customer Phone</th>
                        <th>Total Price</th>
                        <th>Status</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    {% set productsPerPage = 5 %}
                    {% set totalProducts = data|length %}
                    {% set totalPages = (totalProducts / productsPerPage)|round(0,"ceil") %}
                    {% set currentPage = app.request.query.get('page', 1) %}
                    {% set start = (currentPage - 1) * productsPerPage %}
                    {% set end = start + productsPerPage %}
                    {% set sortedData = data|sort((a, b) => a.isStatus() == 1 ? 1 : -1) %}

                    {% for order in sortedData[start:end] %}
                    <tr>
                        <td style="vertical-align: middle;">{{ loop.index }}</td>
                        <td style="vertical-align: middle;">{{ order.getid() }}</td>
                        <td style="vertical-align: middle;">{{ order.getCustomerName() }}</td>
                        <td style="vertical-align: middle;">{{ order.getCustomerAddress() }}</td>
                        <td style="vertical-align: middle;">{{ order.getCustomerPhone() }}</td>
                        <td style="vertical-align: middle;">{{ order.getTotalPrice() }}$</td>
                        <td style="vertical-align: middle;">
                            {% if order.isStatus() == 1 %}
                            done
                            {% else %}
                            pending
                            {% endif %}
                        </td>
                        <td style="vertical-align: middle;">
                            <a href="{{ path('app_orderitem_view', {'id': order.getId()}) }}" class="btn btn-dark" style="font-weight: bold">Detail</a>
                            <a href="javascript:confirmch('{{ path('app_mark', {'id': order.getId()}) }}')" class="btn btn-danger"><i class="fas fa-trash"></i> Done</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            </div>
            <ul class="pagination">
                {% for page in 1..totalPages %}
                    <li class="page-item {% if currentPage == page %}active{% endif %}">
                        <a class="page-link" href="?page={{ page }}">{{ page }}</a>
                    </li>
                {% endfor %}
            </ul>
        </section>
    </div>
</div>

{% endblock %}

{% block javascripts %}
<script>
    function confirmch(url) {
        if (confirm("Are you sure?!")) {
            window.location.href = url;
        }
    }
</script>
{% endblock %}
